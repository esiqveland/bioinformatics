package main

import (
	"fmt"
	"io/ioutil"
	"strings"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestPatternCount(t *testing.T) {
	count := PatternCount("ACTGACTGACTGAT", "ACT")

	if count != 3 {
		t.Errorf("got %v but expected %v", count, 3)
	}

	count = PatternCount("ATATAACTTTGACATA", "ATA")

	if count != 3 {
		t.Errorf("got %v but expected %v", count, 3)
	}

	assert.Equal(t, 6, PatternCount("GACCATCAAAACTGATAAACTACTTAAAAATCAGT", "AAA"))
}

func TestMovingWindowFrequentWords(t *testing.T) {
	data := "CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA"
	dna := strings.ToUpper(data)

	results := MovingWindowFrequentWords(dna, 5, 50, 4)

	fmt.Printf("MovingWindowFrequentWords(dna, 5, 50, 4): %+v\n", results)
	assert.Contains(t, results, "CGACA")
	assert.Contains(t, results, "GAAGA")
}

func TestMovingWindowFrequentWords_big(t *testing.T) {
	data, err := ioutil.ReadFile("test_pat_count.txt")
	if err != nil {
		t.Errorf("error reading test data: %v", err)
	}

	dna := strings.ToUpper(string(data))

	results := MovingWindowFrequentWords(dna, 11, 566, 18)

	fmt.Printf("MovingWindowFrequentWords(dna, 11, 566, 18): %+v\n", results)
	assert.Contains(t, results, "AAACCAGGTGG")
}

// This takes too long
//func TestMovingWindowFrequentWords_bigger(t *testing.T) {
//	data, err := ioutil.ReadFile("dataset_4_5.txt")
//	if err != nil {
//		t.Errorf("error reading test data: %v", err)
//	}
//
//	dna := strings.ToUpper(string(data))
//
//	results := MovingWindowFrequentWords(dna, 10, 481, 18)
//
//	fmt.Printf("MovingWindowFrequentWords(dna, 11, 566, 18): %+v\n", results)
//	assert.Contains(t, results, "TGGCCCTTAC")
//	assert.Contains(t, results, "TAGTAAGCCT")
//	assert.Contains(t, results, "CGAAAAACCG")
//	assert.Contains(t, results, "CCGGCCTTAA")
//	assert.Contains(t, results, "CGGTGCCCCC")
//	assert.Len(t, results, 5)
//}

// Takes too long, ~50 minutes
//func TestMovingWindowFrequentWords_e_coli(t *testing.T) {
//	data, err := ioutil.ReadFile("E_coli.txt")
//	if err != nil {
//		t.Errorf("error reading test data: %v", err)
//	}
//
//	dna := strings.ToUpper(string(data))
//
//	results := MovingWindowFrequentWords(dna, 9, 500, 3)
//
//	fmt.Printf("MovingWindowFrequentWords(dna, 11, 566, 18): %+v\n", results)
//}

func TestRevComplementStr(t *testing.T) {
	expected := "ACCGGGTTTT"

	revComp := RevComplementStr("AAAACCCGGT")

	if revComp != expected {
		t.Errorf("Expected %v but got %v", expected, revComp)
	}

	expected = "CTTTAGACACGAAACTTTAAGGTCCTGTGACGCCGCTGGTAATGTTTGAGATGGCGAGACGAGTTAGGATTCCCAAAAAATCTGGCGTGTTACGGCGGCGAGCTTCTGTCCAACCAACCCCGATAACTTATAGCACCAGCACGAGCGGTGACCGGAGTCCTTTGAGATCACTCGGACATCTAAACTATAGGCTATAAGGTATTCCAGAGCTACTACTGTGTCTTTTACCGTATGGCATTGGAGCCCACTTAAAAGTAAGCTGTACAGTCCGACTAGGGGTCCCTCTCGATAGGGCAGACCGGATCCCGGGGAGCTCTGGACTGCATATCACGAGGTTACTGAGTCTCATAGGGGGCAACGCCACTGGTAAGCGGACCGAGATGCTCGGATGTGAAGACGTGAAGGGAATTTAAGACCTGATTGAATCACTTAACGCTGGCTGTAAGTGGACTACATCACCTCGCAATGCTGGGCTAAGATCCTCGCACGTAGAACGCTCCGATCGTTGCTTATGTGCGTCTAGAAGAGGTAGCACCGAAATATTCTCACCAACTGTTCCACGTTTTCGGTGTTGCACCGAGCGGATCGCGTTCACGACTGATGTCTAAAAGACCTACAGCCGCGACCGGGTTGGGGAAGCTTGAATGATCGACCATCGTTCACGACCTAGTGTGAGTTTGAGATCGTATAATCCGGTCCCATGAGCGGGTATGTCAGTCGTTTTCAACAGGTCGATGCGGCCGAAACACACGAAAGTTTAGATGGGTCGCTTGCACGCGAGCGCTTGCAGCGAACATCTTACCCAAAATGCAACCTCTAACGAATCAAAACGGTGTTCTCCGGCACCCAAGTAGTGCCATTCTTTCGTGTGTGAGACTAAACAGAAACAGCCCCTTAGTCATAACAACTCAACATTCACAGATTGTCCCCTGGGGGGCGGGCCATAAAGCCACTCCTCGTCTACTCTTCACGATGTAGTGAGTCCGTGTGCTGCCGAGGGTCCACCACGACAAGTCCTCCGTGCTAGGCGTGTCCCGTTTGTGTAAGGCAAAGAACTACTGGCCATGTGGTCTCACTCCCTTCGCCCGTCGAGGTCGGAGTGTAGAGTGTCTCATCTCTAAAAGCCGATCTGTACTGTGCTCACCGTAACGCTTCAACAACTCAGCACACGAAGATCGCAGCGGGTAGAATACTCTGAACGGCAAAGGTGTTCTATAGATGGCAAGCGGAATGTGTAACAATTTCAGTGATTTATGGTTTTCCCCCTTAAGTAGATGTGAGCATGGGCCGACCTTCAGTGGAACCGAGATTTACTTCCCAGCCTTGATTACCACGGCGATAGCATTAAACGAAACCTCGTCCGGGACCTCTGAATATGTCCTTCCTATAAAGGTCTTACCGAATACATCACCTTCGCGAACAGACAGAGCCGCCACGTATGCACCGGTCGAAAAAACTGTGGGCATGGATAAACGCAATGAGGTTGAGCAATGCATTTGACGGGGGATCCTGTGACAACCTGCCAATCGATAATACAGTAATCAATGGTTTACGAACTTAGGAGTCGTCTACTTTTCGGATACACCTCGCACATCCGGTAAGTTCTGGCAAAGGCATAAGGGTGTGAGCCTCAAAAGAATCCAACATCTAGATTGTTCCATACAAGATCCTTAAGATCAGGGTTGCCCGCACTCTAATTGTAAAACTCACTTTGAACCGTCCCCCCTTCCACACCCCTATCTGCTCTGGGCGACGTAAGCCCTATTACATTTGCGCTCTCCGAGAACTGCGTATAAATTTGGGATTTGAAAGCCAAGTCTAATGGACCTGAACACCCACTACCCGTGGCTGGACCGTGATGTGGCAGATTGGGGGTCTGTGTCAAACCGGGCGGTGAAACTCGGGGTGGTATGACGATACACGATCTTATCTGCCCAGGTCGGTTTGGTATTCTTTCATCGAGACAGAAAATGTGAACACTAGAAGCTACATGTAGCGAACTGAGATTATTTAGGCAAGACTCAACGAAGGGTCTTCACGGAGCATGTTTCTATACGAGAGGCGACACACGTCACCGCGGAACCATTAAACGGAAGAGGCTGTACCTGGCGTTGATCCACGCCAGATGGCGCCACTGTCGTTCAGAGAGACTAACTACCGGAGTCCGGGAGGTCTCGACCCAGCCTACGTATCACAAACGTCATACACGGACGTTCAGACTAAAAGGCATGCCAGCTGTTGCCGTGGTCCACGACGTGCAAGTCAGTTGCGTTAAGAACCTATTTTGTGCTACACTCGCGGGCGGTCAGAAATTGCCTACGTATACGACAGCACTGGTGTTCCGGCTATTCGATACAGAGCTGGAAATCTATAAGATAAGTATCACCTGGTGTGGGCACCTGGTCTCCACTGGGAAAGAGCCTCAAGGTGACTCCGCCCCCCTCATGAAACCGCTGCGCAGCATATATAGTCTCCGGGAGAGATCTGCTAGGTTAGGCGTCTATCACCAGCCAAGATGACCTTAAGGAAGCTGCCCTTCACGCGCAATGCCAAGGGGTTCACGGCAGCTCGTAACACTAGGTCACAATGAGAGCACTTGTTGTCATTACCTTCTTAGAAGTTAGTGGTGATGGTGTCCGCTATCGGCGTGTCGGTATAAAGCCCTGCAGTGCTCGCTGATGAAGTATAACATCTTGGCAGTATGCATAGCGACAAAGTGACGATTGACGCGTCCGGCTTGTTAAAGGGGACTAATCTACTGCCTGTGTCAGCTTCACCCTTGGGCCGCAATAAGTGCCATATACTCGGGCATGAAACCATCGTAGCTGACAGTTAAAAAGGAGTTCCTCCTCTCGCAAGCCGGTTGCGTGTCTGCGTGACGTCGATGACTTTAGGGTAAAGGACTATGATTAATACACGCCGTTTGATTACCCTATTAGCAAGAGTAGTCCATGCACTACGCATGAAAAATACTATAATGGTTACCTATCGCCATTTAAAGCCCATCGTCAACTGATATACTCGCCTTTTGTTTTAGATACAGGAATAGATGCTTCTTAAAACACAGAGGCTAATCGCGATCTATGTGTTAATGAAGCCTAGAACTTGTAAATATCCACAGACAACTGTTAGCATTATCAGTGCCCGAGACCGGCCGACGGAGTTCGGTAGACGATGTATAGTCGACTTCATGGCATCTGCCGCTTCCCATGCATCGAAACCTACAAGGGGCAGTTCTGGGGCTGGACACTCAGTCCGGGGCAATTTTCGCTCAATTTTTGAACATCTCGATTTATACTTGTTATATGACTAAGAGTGCAGTAACGACATTACACCGGCAATCCGATGCCATAAATATCGGTCGGCCCAGCTGGGATCGCGTTAAGAAGAATACAGGACTGAGCTACGTACGCTCATGACCTTGCGCGATTTCTGAGATCTGTGTCTTACTTCCCTTGCACTCGGATTCTTCACGAAGATGTGCTTAGACCGACGGGGTTGTGGATTTACAGCGAAATTATGCCCGCGGTAGAGCCTGCACATGGCTAATAGGATGACGTCTTACATGCGCAAACATGCTTTCTCGAGACGTACGGTTATGCGCGTCTCTGGTTCCCTCATCACATCCCTGATGTGAGTGACGTTGCCCAGACAAGTCATAGCACATTGCTTGGAATTACTTACAAGGAGAGACACGAACCAACAAGGGTGTCTTACTCCCGTGCAAAGTCCATGTGTTTCTCTTCTACCGGGTGCGAACCATCAGTCATGACCGCATGTTATGTCTCCGAGACATATGCTTATTCACGCAAGATTCCGAATGCGCCAATTCTAGCGATGCCTGAAGCCTACTAACATTCCCTCACGGAATGGTCCTGCCTGGCTCTTGGCTCACACCGGCCATGCTAGTGAAATAGATTAGTTATGACTTCTCGATGGACGCAATGAAGTGCTTACGGACCTCCTGATTAAGCGGCCCTCTCCATCTCCATATACTAAAGTCTAAGGCCTTAAAGTTCACCTGCAGACTGGGTACTCTCATTAAAGTACGCCTTGTATGGCGGCAATTCTCAAATGTTTCTCTAAATTGAGAGAAAGACATTGCTAGTCAGTAGGGACACTCGCATCCGTTCTCAGCTACTCATAGCGGATTAGCACAAGCTATCGGCGAGCGTACGTCGCTCCTTGAACTGGTGTACTGCCGTATAATGAACACAGCTGGTGTCTATTAGTCCACGTCCGGAAGAGAGTGTTCTAGGTATGTCACTACAGATTCTTCGCGAGGCCGGGCACGACGAGACCACTAGCAGTACCCATGCAGGTGCCATTAGCGTCGGTAGATGCTCTGATGATATAAAATGCTCGCTAGTGCTGTAGATGGTTGGTTCGACCGGCACGGGTAGGATAATTTCACAACCCCGGGATACCTAGACTGTCGTACGGTCGTCTTCGTTTTCTTAGACAAGCTTATTAGTACGAGTCGAAGTGTGGCCGTTACGTCATAGTTGATTATGTAACGACGCTTACCCGACAAATGCAATTTGCTCTAAGCGCCCGATCAGAAGGAGTCCCTTACCCCAGGTCAGCCAAGGCACACCCTCAGTTGCTTGTAGTATCAGGATGGCTATTTTTTTTTTCGGTCGAGTCTGATCACTCCAACCTCTCTCCCTGATATATCTGATACATTGGCCGTGCCCAGACAATGGAACCTCACTTATTCAGCTAGATAGGTCGAGGTCGGAGGGTTATCCCTCATCGCTCGACTTAGGCTTCCATCTGATATGTAATACAATCATCCACGTGGGGAGCCCCCGCACATTATAAAGGCCATCTTGGCATGCAAAGCTGCCGGCGTGCCCCACAGTACTTCAGTGGCATGCTACCTACTGTGTGAGGGGAGGCAGAAGGGTCGTCCGACTCAGATGGCTTACAAGCTTGTAGGATTGCAGCTTCACATTCAGACACGAGGAGTCGCGCGCCATCCCATGCTGTAACACGTAACACACCGGACGCGACCCACGGCATCGAAATTGATGAACTCGAACGCCGACTCCCGGCTATGACCTGTTACGACAGAAATGAGTGCTGGCGCTCCTAATCTAGGCGACGCTAGACTAATGGCATGCCCTGGGACAGTTCGATCATCACTCAGGGTTCGCAGTAGACACAGAACCTAAAACATGCGGATCTACCACGGTTATCTATGGGAACTGACGTGGGTGGGATGCATGTGACACTCACCGACGGACTGGGTATTCGGAAACCTTATTTGCGTTAGCAGCGCCAGCATGGGAGGTTTGCTACCTTTGAGCGGATGCCATTATATGTTGGTACGTGTCGTGAGTGCAGCGAGTGCAACCTTTCGAAGTCTAAGCGAAAACAATTCCCAAATGAGTCTAGACCCCGTTGAATCTATCAGAGTGACTTGGGCAGAAGTACGTATGCAGCTGCAGTAGTGTGTGCAACCCTGTTGTCTTCCCCGGACGCGCCGTGTATTCTCAGCACTCATGCTTATTAGATGTTGCCCGACCTTAATAACGATTAAATCCGGTAGAGGCTAAGAGAGTTGAGCCGTGGAGGGATTTAGGGCCGTACTCCCGACTACGCAAGGCAAGTTGTTAAGGCTCCGGGTCAGTGGTAGCAGTGAGTGAATACCTCGAAGTGGCCCTCGGTCATTTCATGTTCCCTACTGGCGAGTACACTATAAGATCGTTGTATACCTACTAGCCCGACCGTCCTAGCATAGAACGCCACATGTTGGGTGAAACTCAGGATATATACAACGCTCCCGTAGGTTTTACTTCTTGTTATGGCCGAAGGCTTGTGAATGTTTATAACCGCCCCTCCGAATCGATTGTAATACGACTTTGCGCTTCAACCCAGTCCCTAACTAAAGAACCCCTATCCGCTGGAGCGCGAATCATGGTCTAGGCAACGGGACCTCTTGGCGGGTGGTATCAGCGTATCAATGTGGATCATGATTCAGGACCGTTGCCTCTCAAGCACTGTGTCGTGTTTACGCCGCGCCGCGTTCTCTTATCTGCAACCCTTGGAATTTGCAACCGAATCGAGTGGCACATCATTGAATGTACAGGGTGGCGGGCTTCCCAACTCATCTTGCGGACGGACACAAAGTCATCCTATTTCGGTTCTAATCGGTGCCACACCCAGTACTTGCGACCTAAGAGCTCCATCAACTATTAGTACATGCCCTGGGTCACGGTCACTTACAGCTAGGCCGACGGGGTTGGCCGCGTCAAGCCCAAGTTAATAAGGTCCTGTTCAGGGACTGACCCTACAAGATACAGGACGTAGAGGCTTGGCCGACCTATACCTACGATAGTCTCGCGTTCACGGGTATCGTGTTCGTGCGTAGCGTCTGTGTAGATATGATCTGCTATAAGGTCAGTCCGTGAGCGCGAGTTATGCCTAGAATGCAGTGGTTCCATTGTAACGGATCCGAGTTAGCGATTTCTAAACGGTTGGTTAATCGGTACCTCGCGCGCCCGGTCTTGTAGCTGTGCTGTGCGAGTGTCTCAAGATAGAGTCATTGAGCCACATTCAAAATTAAATCGGGTGGGGTTATCTAGGTTGAGCAGATAGACGGGATGCCGGCTTGGTGATCTAGAACACACCACATTCTCGTAGGCTTAAGACAACGAGTAAGTTAACTCTATTTTACGCCTAATCTTCCTAGTTTCGAGCCCCGGTCGGCGATGGTGACTAGGATACGTTTATCGTAGTATGTTTAAAACCATGTCATAGCTGTTGAGGGTGTGGCACTGATATGCAGTCTACCCGTCACTCATTGGGTGCCGCGTCGGGATGTTGGAGGGGTCGGTGTTTGGCGGTCCGGGGAACTCCATTAGCGCGAACTTCCTAACGAATACGGAATAGAGTGAAATGCTCTGAACTCATGTGAGTAATTCTCCATCAGGTAGATTCACACATTACTTAATAGGTTCTATCGGCTCATCTGTAACGACGGGACCCGCTATTCACTCGGATAAAGCCGTTATTTTATGGAGCTTACCCTGACCTTTCTAATGCGTTGCCACAGGGACTAGTCCCTGCAAAATTTACGCCAGTGATTATTGTGGCCTAGAGTCCAGGCAATACAGGGTAGCGAGAGCAAGGTGTCGCAGCAGGAGGTGTTACGAAAGTCCGAGTAATTGGCAGGAAACATTAGTCCCGAGCCAAATGTTGCGTTTATGCAACCCCTATTCTTTACATTAGAAGCACATATCAACAGGACCTATCAGAATGTTTGCGCTCGTCACAACCCATAGCAGTGTCCTAGAGCGTCCGCGCCCTCACAAGGAGGGCAACGCAGTAGCCACTTTAAATTGGTCAGGGGATTGCGACATTAGTACGCATCCATCCATCTTAGGGAATCGATAGGTATCTTCCCGACCGTCAAGGCTGTTAAACTAGAGAGATAAATTCAAATGAACTGGCAGACGTTGTGGATCAAAGCCACTTTTCTATGCACAGAGACGACCGCGCGCTCTGGGGACTCTGCCCAAGTACCAATCCGGCTGAGGGTCATCCTTTTTTAGGTCAGTGTATAACGCCTTCATATTAGGTCTGGCTGTAAACAAGCCTGAGCACTCGAACGGTTATCGTCCTCTCTCTTCCACGGACCGGTTATTGTTCGAAACTAGCCAGGTAATGGGGCGGGTCCGGTCGCTGATTCGTCGCATCTGCTTTTGTTGGTCCATACATCTAAAGTACCGTTTCTTATCAGCGCTTTTCGCTCATGAGTGCTCAATTCCTGACCGGACGGGTTATTGGGCCCAGGTACGGCCCTTGCCAACCATGTTATGAGCAAGCTCTAACCGGTCGACGCACCTATAAGCTGTGATGCGTGTAAGCGTTAACTCTAGGTCGCGGTTCCTTCAAGTGAGTACATCGACGGACGTAACGCCGCGCACCGAACATGGTTATTTGAGCGCTATCTGTCGACGCCCGAGTAAATTAGTCCTGCCTGAGAGTGGGAATGAGGGTCTCACGCCTCGATTACCCGTCGTACTGGGGCTTCATTTTCAAATTAGTTCTATATGTGCGGAGCTACGGGCGTCCAATATTGTTCGAGCGACAGTTCCAGTCCGTCCCCAATTGAGTATTGGTAGCACAGGACACACATGGACTGCATGCCACCTTCCGCTTGCACCCATCCGAGCCGGTCAACACCCTGGATGAGACATCGAAGCACTGTTAGAGCGGGGTCGGGTCTACGGAGGATTGTTTTCGGACCGCTAATAGGCCATGTCTGCAAAGGGTAGGAAGAAAAGGAGACAAACAGAGCAGAGATATATCTCTAGTATTGAGTCTAAGTAGGAATATGTTTTGATGGACAGTCGAAGGGTGTCTGACGCAGATTGTATGGCACACCGAGCGCGTGACGGGAGGTCATTAGTTTCTGCGCGACCACAAGGGTCGGATCAAGTACTTTTGAGAAGTAAAGGCGCTCAATTTATTACTGTTTTGACCGTGTGTCTGTTTAAACGCGGGCCACATAACACGAAGAAGCGACTCTAGCTGAAGTCTCTGACTTGATGTACTAAAAGTGTCAGGGCCTGGTTAAAGTAAATCGGCTAGGAGTAGGCGATTCATTATAGGGATAATGGTAGATTGAAGGCCCAATCACCCTCATCCTCGCAGCCGTCGGGACTAGTCCTACGGATGGAGTCGCACAAAGGTTCGATGCTTTACTTACAGCGAGGTCCTGCGGTGCGGGGTGAGCGTTGCCTCGAGACCTAGCAACCCTCAACAGTAGTCGTGGGCATAAAGTTAGAGCGCTCGAAAGATACAGTTAGACACGGCCACTCATAGAACCGCCATCTGTTCCAGGTATTACGTCTCTCGGTCGTGAAAGGGCAGGCGCTAAAGAGGCTACGGGCTAAAAAGCCAGGTGCTAACTTAATACTAGTTAGAGGAACCATCGAAGCTCCCGCGCAGAACTTTGTAAGTCAGAGTAAAACGCATGAAAAGAATAGAGGCCAGTGGCGCTTAACGTACGCGGCTATTATCAAGTACGTACTCTCTCCATAGGCGAGTCTTTGGCCCCTAACACCTTGACCGTACAGCCGCCTTACCATCATCATAGGACCTTCCAATTCGGCCCATTCGTCGTGTGCACATATCACGGGGGGCAGTGGGGCTTAACCCATCCAGCAGGAGAACCAGTGGCCCATAGTGATGCGGCTCGAGATGTATAATGTCTTAAGAGGCGATGCCGGCACGATGGGTTTGCCGAATGTAGCGGCCGGTAATCAACTATCCCCCATGGTCCTTAATTTTGTACGTTGGACTAAGAGGACCACCGGGAGGTTAAGAGGGGACGGAGATACTGGGTCCTCGGGCGGTCCTACAGTTAGCCGACTGGATCAATCGCAACAGGGCGTTTGGCAGATCGGGGTACTATTTGCACTCGGCTAAAGTACTGATTGTTCGATCCTGCGAGATCAGCAGGTCGCGCGCAGGACTCGGCTTATGCATTTTAAGCCTGGAGGCGGTGCGACACCTTCACGTAAACAGTGGAAGTCGTTACGGCGGGAAAACGACCATAGTGCCCGTATTAAGTAGTTCCAGCATTTTCTTAAGTCCGTCGATGCCGACAACTAACTTGTACAGTAGAAATCATACGGCAGTGTATCCGGATTGTTCACAAATGAAACTGTTCTTATGATACCAGGGCCTCGGAGACTAACATCGTTTCTTCGGGGGGGGGGTTCGGTCGCATTTGGCCCACGA"
	revComp = RevComplementStr("TCGTGGGCCAAATGCGACCGAACCCCCCCCCCGAAGAAACGATGTTAGTCTCCGAGGCCCTGGTATCATAAGAACAGTTTCATTTGTGAACAATCCGGATACACTGCCGTATGATTTCTACTGTACAAGTTAGTTGTCGGCATCGACGGACTTAAGAAAATGCTGGAACTACTTAATACGGGCACTATGGTCGTTTTCCCGCCGTAACGACTTCCACTGTTTACGTGAAGGTGTCGCACCGCCTCCAGGCTTAAAATGCATAAGCCGAGTCCTGCGCGCGACCTGCTGATCTCGCAGGATCGAACAATCAGTACTTTAGCCGAGTGCAAATAGTACCCCGATCTGCCAAACGCCCTGTTGCGATTGATCCAGTCGGCTAACTGTAGGACCGCCCGAGGACCCAGTATCTCCGTCCCCTCTTAACCTCCCGGTGGTCCTCTTAGTCCAACGTACAAAATTAAGGACCATGGGGGATAGTTGATTACCGGCCGCTACATTCGGCAAACCCATCGTGCCGGCATCGCCTCTTAAGACATTATACATCTCGAGCCGCATCACTATGGGCCACTGGTTCTCCTGCTGGATGGGTTAAGCCCCACTGCCCCCCGTGATATGTGCACACGACGAATGGGCCGAATTGGAAGGTCCTATGATGATGGTAAGGCGGCTGTACGGTCAAGGTGTTAGGGGCCAAAGACTCGCCTATGGAGAGAGTACGTACTTGATAATAGCCGCGTACGTTAAGCGCCACTGGCCTCTATTCTTTTCATGCGTTTTACTCTGACTTACAAAGTTCTGCGCGGGAGCTTCGATGGTTCCTCTAACTAGTATTAAGTTAGCACCTGGCTTTTTAGCCCGTAGCCTCTTTAGCGCCTGCCCTTTCACGACCGAGAGACGTAATACCTGGAACAGATGGCGGTTCTATGAGTGGCCGTGTCTAACTGTATCTTTCGAGCGCTCTAACTTTATGCCCACGACTACTGTTGAGGGTTGCTAGGTCTCGAGGCAACGCTCACCCCGCACCGCAGGACCTCGCTGTAAGTAAAGCATCGAACCTTTGTGCGACTCCATCCGTAGGACTAGTCCCGACGGCTGCGAGGATGAGGGTGATTGGGCCTTCAATCTACCATTATCCCTATAATGAATCGCCTACTCCTAGCCGATTTACTTTAACCAGGCCCTGACACTTTTAGTACATCAAGTCAGAGACTTCAGCTAGAGTCGCTTCTTCGTGTTATGTGGCCCGCGTTTAAACAGACACACGGTCAAAACAGTAATAAATTGAGCGCCTTTACTTCTCAAAAGTACTTGATCCGACCCTTGTGGTCGCGCAGAAACTAATGACCTCCCGTCACGCGCTCGGTGTGCCATACAATCTGCGTCAGACACCCTTCGACTGTCCATCAAAACATATTCCTACTTAGACTCAATACTAGAGATATATCTCTGCTCTGTTTGTCTCCTTTTCTTCCTACCCTTTGCAGACATGGCCTATTAGCGGTCCGAAAACAATCCTCCGTAGACCCGACCCCGCTCTAACAGTGCTTCGATGTCTCATCCAGGGTGTTGACCGGCTCGGATGGGTGCAAGCGGAAGGTGGCATGCAGTCCATGTGTGTCCTGTGCTACCAATACTCAATTGGGGACGGACTGGAACTGTCGCTCGAACAATATTGGACGCCCGTAGCTCCGCACATATAGAACTAATTTGAAAATGAAGCCCCAGTACGACGGGTAATCGAGGCGTGAGACCCTCATTCCCACTCTCAGGCAGGACTAATTTACTCGGGCGTCGACAGATAGCGCTCAAATAACCATGTTCGGTGCGCGGCGTTACGTCCGTCGATGTACTCACTTGAAGGAACCGCGACCTAGAGTTAACGCTTACACGCATCACAGCTTATAGGTGCGTCGACCGGTTAGAGCTTGCTCATAACATGGTTGGCAAGGGCCGTACCTGGGCCCAATAACCCGTCCGGTCAGGAATTGAGCACTCATGAGCGAAAAGCGCTGATAAGAAACGGTACTTTAGATGTATGGACCAACAAAAGCAGATGCGACGAATCAGCGACCGGACCCGCCCCATTACCTGGCTAGTTTCGAACAATAACCGGTCCGTGGAAGAGAGAGGACGATAACCGTTCGAGTGCTCAGGCTTGTTTACAGCCAGACCTAATATGAAGGCGTTATACACTGACCTAAAAAAGGATGACCCTCAGCCGGATTGGTACTTGGGCAGAGTCCCCAGAGCGCGCGGTCGTCTCTGTGCATAGAAAAGTGGCTTTGATCCACAACGTCTGCCAGTTCATTTGAATTTATCTCTCTAGTTTAACAGCCTTGACGGTCGGGAAGATACCTATCGATTCCCTAAGATGGATGGATGCGTACTAATGTCGCAATCCCCTGACCAATTTAAAGTGGCTACTGCGTTGCCCTCCTTGTGAGGGCGCGGACGCTCTAGGACACTGCTATGGGTTGTGACGAGCGCAAACATTCTGATAGGTCCTGTTGATATGTGCTTCTAATGTAAAGAATAGGGGTTGCATAAACGCAACATTTGGCTCGGGACTAATGTTTCCTGCCAATTACTCGGACTTTCGTAACACCTCCTGCTGCGACACCTTGCTCTCGCTACCCTGTATTGCCTGGACTCTAGGCCACAATAATCACTGGCGTAAATTTTGCAGGGACTAGTCCCTGTGGCAACGCATTAGAAAGGTCAGGGTAAGCTCCATAAAATAACGGCTTTATCCGAGTGAATAGCGGGTCCCGTCGTTACAGATGAGCCGATAGAACCTATTAAGTAATGTGTGAATCTACCTGATGGAGAATTACTCACATGAGTTCAGAGCATTTCACTCTATTCCGTATTCGTTAGGAAGTTCGCGCTAATGGAGTTCCCCGGACCGCCAAACACCGACCCCTCCAACATCCCGACGCGGCACCCAATGAGTGACGGGTAGACTGCATATCAGTGCCACACCCTCAACAGCTATGACATGGTTTTAAACATACTACGATAAACGTATCCTAGTCACCATCGCCGACCGGGGCTCGAAACTAGGAAGATTAGGCGTAAAATAGAGTTAACTTACTCGTTGTCTTAAGCCTACGAGAATGTGGTGTGTTCTAGATCACCAAGCCGGCATCCCGTCTATCTGCTCAACCTAGATAACCCCACCCGATTTAATTTTGAATGTGGCTCAATGACTCTATCTTGAGACACTCGCACAGCACAGCTACAAGACCGGGCGCGCGAGGTACCGATTAACCAACCGTTTAGAAATCGCTAACTCGGATCCGTTACAATGGAACCACTGCATTCTAGGCATAACTCGCGCTCACGGACTGACCTTATAGCAGATCATATCTACACAGACGCTACGCACGAACACGATACCCGTGAACGCGAGACTATCGTAGGTATAGGTCGGCCAAGCCTCTACGTCCTGTATCTTGTAGGGTCAGTCCCTGAACAGGACCTTATTAACTTGGGCTTGACGCGGCCAACCCCGTCGGCCTAGCTGTAAGTGACCGTGACCCAGGGCATGTACTAATAGTTGATGGAGCTCTTAGGTCGCAAGTACTGGGTGTGGCACCGATTAGAACCGAAATAGGATGACTTTGTGTCCGTCCGCAAGATGAGTTGGGAAGCCCGCCACCCTGTACATTCAATGATGTGCCACTCGATTCGGTTGCAAATTCCAAGGGTTGCAGATAAGAGAACGCGGCGCGGCGTAAACACGACACAGTGCTTGAGAGGCAACGGTCCTGAATCATGATCCACATTGATACGCTGATACCACCCGCCAAGAGGTCCCGTTGCCTAGACCATGATTCGCGCTCCAGCGGATAGGGGTTCTTTAGTTAGGGACTGGGTTGAAGCGCAAAGTCGTATTACAATCGATTCGGAGGGGCGGTTATAAACATTCACAAGCCTTCGGCCATAACAAGAAGTAAAACCTACGGGAGCGTTGTATATATCCTGAGTTTCACCCAACATGTGGCGTTCTATGCTAGGACGGTCGGGCTAGTAGGTATACAACGATCTTATAGTGTACTCGCCAGTAGGGAACATGAAATGACCGAGGGCCACTTCGAGGTATTCACTCACTGCTACCACTGACCCGGAGCCTTAACAACTTGCCTTGCGTAGTCGGGAGTACGGCCCTAAATCCCTCCACGGCTCAACTCTCTTAGCCTCTACCGGATTTAATCGTTATTAAGGTCGGGCAACATCTAATAAGCATGAGTGCTGAGAATACACGGCGCGTCCGGGGAAGACAACAGGGTTGCACACACTACTGCAGCTGCATACGTACTTCTGCCCAAGTCACTCTGATAGATTCAACGGGGTCTAGACTCATTTGGGAATTGTTTTCGCTTAGACTTCGAAAGGTTGCACTCGCTGCACTCACGACACGTACCAACATATAATGGCATCCGCTCAAAGGTAGCAAACCTCCCATGCTGGCGCTGCTAACGCAAATAAGGTTTCCGAATACCCAGTCCGTCGGTGAGTGTCACATGCATCCCACCCACGTCAGTTCCCATAGATAACCGTGGTAGATCCGCATGTTTTAGGTTCTGTGTCTACTGCGAACCCTGAGTGATGATCGAACTGTCCCAGGGCATGCCATTAGTCTAGCGTCGCCTAGATTAGGAGCGCCAGCACTCATTTCTGTCGTAACAGGTCATAGCCGGGAGTCGGCGTTCGAGTTCATCAATTTCGATGCCGTGGGTCGCGTCCGGTGTGTTACGTGTTACAGCATGGGATGGCGCGCGACTCCTCGTGTCTGAATGTGAAGCTGCAATCCTACAAGCTTGTAAGCCATCTGAGTCGGACGACCCTTCTGCCTCCCCTCACACAGTAGGTAGCATGCCACTGAAGTACTGTGGGGCACGCCGGCAGCTTTGCATGCCAAGATGGCCTTTATAATGTGCGGGGGCTCCCCACGTGGATGATTGTATTACATATCAGATGGAAGCCTAAGTCGAGCGATGAGGGATAACCCTCCGACCTCGACCTATCTAGCTGAATAAGTGAGGTTCCATTGTCTGGGCACGGCCAATGTATCAGATATATCAGGGAGAGAGGTTGGAGTGATCAGACTCGACCGAAAAAAAAAATAGCCATCCTGATACTACAAGCAACTGAGGGTGTGCCTTGGCTGACCTGGGGTAAGGGACTCCTTCTGATCGGGCGCTTAGAGCAAATTGCATTTGTCGGGTAAGCGTCGTTACATAATCAACTATGACGTAACGGCCACACTTCGACTCGTACTAATAAGCTTGTCTAAGAAAACGAAGACGACCGTACGACAGTCTAGGTATCCCGGGGTTGTGAAATTATCCTACCCGTGCCGGTCGAACCAACCATCTACAGCACTAGCGAGCATTTTATATCATCAGAGCATCTACCGACGCTAATGGCACCTGCATGGGTACTGCTAGTGGTCTCGTCGTGCCCGGCCTCGCGAAGAATCTGTAGTGACATACCTAGAACACTCTCTTCCGGACGTGGACTAATAGACACCAGCTGTGTTCATTATACGGCAGTACACCAGTTCAAGGAGCGACGTACGCTCGCCGATAGCTTGTGCTAATCCGCTATGAGTAGCTGAGAACGGATGCGAGTGTCCCTACTGACTAGCAATGTCTTTCTCTCAATTTAGAGAAACATTTGAGAATTGCCGCCATACAAGGCGTACTTTAATGAGAGTACCCAGTCTGCAGGTGAACTTTAAGGCCTTAGACTTTAGTATATGGAGATGGAGAGGGCCGCTTAATCAGGAGGTCCGTAAGCACTTCATTGCGTCCATCGAGAAGTCATAACTAATCTATTTCACTAGCATGGCCGGTGTGAGCCAAGAGCCAGGCAGGACCATTCCGTGAGGGAATGTTAGTAGGCTTCAGGCATCGCTAGAATTGGCGCATTCGGAATCTTGCGTGAATAAGCATATGTCTCGGAGACATAACATGCGGTCATGACTGATGGTTCGCACCCGGTAGAAGAGAAACACATGGACTTTGCACGGGAGTAAGACACCCTTGTTGGTTCGTGTCTCTCCTTGTAAGTAATTCCAAGCAATGTGCTATGACTTGTCTGGGCAACGTCACTCACATCAGGGATGTGATGAGGGAACCAGAGACGCGCATAACCGTACGTCTCGAGAAAGCATGTTTGCGCATGTAAGACGTCATCCTATTAGCCATGTGCAGGCTCTACCGCGGGCATAATTTCGCTGTAAATCCACAACCCCGTCGGTCTAAGCACATCTTCGTGAAGAATCCGAGTGCAAGGGAAGTAAGACACAGATCTCAGAAATCGCGCAAGGTCATGAGCGTACGTAGCTCAGTCCTGTATTCTTCTTAACGCGATCCCAGCTGGGCCGACCGATATTTATGGCATCGGATTGCCGGTGTAATGTCGTTACTGCACTCTTAGTCATATAACAAGTATAAATCGAGATGTTCAAAAATTGAGCGAAAATTGCCCCGGACTGAGTGTCCAGCCCCAGAACTGCCCCTTGTAGGTTTCGATGCATGGGAAGCGGCAGATGCCATGAAGTCGACTATACATCGTCTACCGAACTCCGTCGGCCGGTCTCGGGCACTGATAATGCTAACAGTTGTCTGTGGATATTTACAAGTTCTAGGCTTCATTAACACATAGATCGCGATTAGCCTCTGTGTTTTAAGAAGCATCTATTCCTGTATCTAAAACAAAAGGCGAGTATATCAGTTGACGATGGGCTTTAAATGGCGATAGGTAACCATTATAGTATTTTTCATGCGTAGTGCATGGACTACTCTTGCTAATAGGGTAATCAAACGGCGTGTATTAATCATAGTCCTTTACCCTAAAGTCATCGACGTCACGCAGACACGCAACCGGCTTGCGAGAGGAGGAACTCCTTTTTAACTGTCAGCTACGATGGTTTCATGCCCGAGTATATGGCACTTATTGCGGCCCAAGGGTGAAGCTGACACAGGCAGTAGATTAGTCCCCTTTAACAAGCCGGACGCGTCAATCGTCACTTTGTCGCTATGCATACTGCCAAGATGTTATACTTCATCAGCGAGCACTGCAGGGCTTTATACCGACACGCCGATAGCGGACACCATCACCACTAACTTCTAAGAAGGTAATGACAACAAGTGCTCTCATTGTGACCTAGTGTTACGAGCTGCCGTGAACCCCTTGGCATTGCGCGTGAAGGGCAGCTTCCTTAAGGTCATCTTGGCTGGTGATAGACGCCTAACCTAGCAGATCTCTCCCGGAGACTATATATGCTGCGCAGCGGTTTCATGAGGGGGGCGGAGTCACCTTGAGGCTCTTTCCCAGTGGAGACCAGGTGCCCACACCAGGTGATACTTATCTTATAGATTTCCAGCTCTGTATCGAATAGCCGGAACACCAGTGCTGTCGTATACGTAGGCAATTTCTGACCGCCCGCGAGTGTAGCACAAAATAGGTTCTTAACGCAACTGACTTGCACGTCGTGGACCACGGCAACAGCTGGCATGCCTTTTAGTCTGAACGTCCGTGTATGACGTTTGTGATACGTAGGCTGGGTCGAGACCTCCCGGACTCCGGTAGTTAGTCTCTCTGAACGACAGTGGCGCCATCTGGCGTGGATCAACGCCAGGTACAGCCTCTTCCGTTTAATGGTTCCGCGGTGACGTGTGTCGCCTCTCGTATAGAAACATGCTCCGTGAAGACCCTTCGTTGAGTCTTGCCTAAATAATCTCAGTTCGCTACATGTAGCTTCTAGTGTTCACATTTTCTGTCTCGATGAAAGAATACCAAACCGACCTGGGCAGATAAGATCGTGTATCGTCATACCACCCCGAGTTTCACCGCCCGGTTTGACACAGACCCCCAATCTGCCACATCACGGTCCAGCCACGGGTAGTGGGTGTTCAGGTCCATTAGACTTGGCTTTCAAATCCCAAATTTATACGCAGTTCTCGGAGAGCGCAAATGTAATAGGGCTTACGTCGCCCAGAGCAGATAGGGGTGTGGAAGGGGGGACGGTTCAAAGTGAGTTTTACAATTAGAGTGCGGGCAACCCTGATCTTAAGGATCTTGTATGGAACAATCTAGATGTTGGATTCTTTTGAGGCTCACACCCTTATGCCTTTGCCAGAACTTACCGGATGTGCGAGGTGTATCCGAAAAGTAGACGACTCCTAAGTTCGTAAACCATTGATTACTGTATTATCGATTGGCAGGTTGTCACAGGATCCCCCGTCAAATGCATTGCTCAACCTCATTGCGTTTATCCATGCCCACAGTTTTTTCGACCGGTGCATACGTGGCGGCTCTGTCTGTTCGCGAAGGTGATGTATTCGGTAAGACCTTTATAGGAAGGACATATTCAGAGGTCCCGGACGAGGTTTCGTTTAATGCTATCGCCGTGGTAATCAAGGCTGGGAAGTAAATCTCGGTTCCACTGAAGGTCGGCCCATGCTCACATCTACTTAAGGGGGAAAACCATAAATCACTGAAATTGTTACACATTCCGCTTGCCATCTATAGAACACCTTTGCCGTTCAGAGTATTCTACCCGCTGCGATCTTCGTGTGCTGAGTTGTTGAAGCGTTACGGTGAGCACAGTACAGATCGGCTTTTAGAGATGAGACACTCTACACTCCGACCTCGACGGGCGAAGGGAGTGAGACCACATGGCCAGTAGTTCTTTGCCTTACACAAACGGGACACGCCTAGCACGGAGGACTTGTCGTGGTGGACCCTCGGCAGCACACGGACTCACTACATCGTGAAGAGTAGACGAGGAGTGGCTTTATGGCCCGCCCCCCAGGGGACAATCTGTGAATGTTGAGTTGTTATGACTAAGGGGCTGTTTCTGTTTAGTCTCACACACGAAAGAATGGCACTACTTGGGTGCCGGAGAACACCGTTTTGATTCGTTAGAGGTTGCATTTTGGGTAAGATGTTCGCTGCAAGCGCTCGCGTGCAAGCGACCCATCTAAACTTTCGTGTGTTTCGGCCGCATCGACCTGTTGAAAACGACTGACATACCCGCTCATGGGACCGGATTATACGATCTCAAACTCACACTAGGTCGTGAACGATGGTCGATCATTCAAGCTTCCCCAACCCGGTCGCGGCTGTAGGTCTTTTAGACATCAGTCGTGAACGCGATCCGCTCGGTGCAACACCGAAAACGTGGAACAGTTGGTGAGAATATTTCGGTGCTACCTCTTCTAGACGCACATAAGCAACGATCGGAGCGTTCTACGTGCGAGGATCTTAGCCCAGCATTGCGAGGTGATGTAGTCCACTTACAGCCAGCGTTAAGTGATTCAATCAGGTCTTAAATTCCCTTCACGTCTTCACATCCGAGCATCTCGGTCCGCTTACCAGTGGCGTTGCCCCCTATGAGACTCAGTAACCTCGTGATATGCAGTCCAGAGCTCCCCGGGATCCGGTCTGCCCTATCGAGAGGGACCCCTAGTCGGACTGTACAGCTTACTTTTAAGTGGGCTCCAATGCCATACGGTAAAAGACACAGTAGTAGCTCTGGAATACCTTATAGCCTATAGTTTAGATGTCCGAGTGATCTCAAAGGACTCCGGTCACCGCTCGTGCTGGTGCTATAAGTTATCGGGGTTGGTTGGACAGAAGCTCGCCGCCGTAACACGCCAGATTTTTTGGGAATCCTAACTCGTCTCGCCATCTCAAACATTACCAGCGGCGTCACAGGACCTTAAAGTTTCGTGTCTAAAG")
	if revComp != expected {
		t.Errorf("Expected %v but got %v", expected, revComp)
	}
}

func TestSubStringPositionsAsString(t *testing.T) {
	expected := "1 3 9"

	result := SubStringPositionsAsString("GATATATGCATATACTT", "ATAT")
	if result != expected {
		t.Errorf("Expected %v but got %v", expected, result)
	}
}

func TestSubStringPositionsAsString_Test3(t *testing.T) {
	expected := "4 6 14"

	result := SubStringPositionsAsString("GACGATATACGACGATA", "ATA")
	if result != expected {
		t.Errorf("Expected %v but got %v", expected, result)
	}
}

func TestSubStringPositionsAsString_2(t *testing.T) {
	expected := "8 42 124 141 187 244 251 267 298 315 334 354 361 381 403 427 452 480 539 629 661 741 748 789 819 828 844 851 867 892 899 906 956 979 1008 1015 1022 1073 1080 1100 1206 1235 1266 1299 1347 1426 1441 1490 1500 1611 1626 1633 1662 1701 1804 1915 1958 1977 1999 2006 2076 2102 2117 2135 2162 2178 2185 2208 2215 2222 2264 2353 2372 2379 2405 2465 2490 2586 2624 2631 2715 2731 2738 2745 2752 2773 2800 2827 2901 2971 3061 3118 3134 3206 3213 3252 3281 3314 3329 3373 3401 3428 3435 3470 3482 3566 3695 3759 3792 3831 3838 3845 3872 3902 3920 3927 3934 3994 4058 4065 4160 4190 4197 4212 4219 4242 4316 4398 4423 4430 4437 4556 4563 4585 4639 4680 4710 4739 4780 4809 4816 4961 5004 5011 5036 5043 5050 5066 5082 5204 5250 5296 5338 5345 5352 5359 5366 5443 5495 5511 5598 5605 5646 5700 5707 5795 5845 5885 5910 5925 5988 5995 6029 6036 6043 6050 6081 6088 6233 6240 6275 6298 6318 6337 6353 6426 6466 6531 6540 6556 6570 6595 6612 6637 6694 6719 6749 6756 6797 6815 6996 7014 7039 7089 7096 7135 7201 7228 7423 7446 7453 7469 7476 7483 7524 7547 7591 7598 7605 7612 7654 7687 7694 7729 7749 7833 7899 7906 7913 7932 8022 8029 8036 8056 8220 8295 8310 8326 8333 8367 8446 8532 8544 8551 8558 8574 8646 8653 8685 8744 8751 8758 8842 8858 8865 8933 8950 8969 8996 9003 9069 9114 9121 9128 9145 9290 9385 9392 9399 9414 9439 9456 9544 9593 9686 9784"

	result := SubStringPositionsAsString(
		"ATCACAGTTGAGGGATGAGGGAGGTGAGGGAACCAGGACATTTGAGGGATGAGTGAGGGATTGAGGGACTTTACTTTTGAGGGACGGTGTATCCATGAGGGACGTGAGGGAAATGAGGGACGTTTGAGGGATGAGGGAGAATGAGGGATGAGGGACGCTGAGGGACTGAGGGATATTTGAGGGAGTTTGAGGGATGAGGGATCCTGAGGGATTGAGGGACAATAACCATTATGGAATGAGGGATTGAGGGATGAGGGATGAGGGAAGTGAGGGATGTGAGGGAGTGTGAGGGATCACTTGAGGGATGAGGGATATTGAGGGATGAGGGAGTCGGTGAGGGATGAGGGAATCCTTTGAGGGATGAGGGATGAGGGATATAGATGAGGGATGAGGGATCGGTGAGTGAGGGATGAGGGAGATGAGGGAATGAGGGATGAGGGAAATTGAGGGACTGAGGGATGAGGGAATGTGAGGGAAACTTGAGGGATGAGGGAGCTGAGGGAGTGAGGGATATGAGGGAGTGTCCCGCCTGAGGGAACTGAGGGATGAGGGATACCGTGAGGGAATCCAATGAGGGATTAGGCCTTGAGGGAGTGGCTTTTGAGGGAATGAGGGAATGAGGGACGCACTGAGGGATGAGGGATACATCGTTTGAGGGACGTGAGGGATGAGGGATCGTGAGGGAACTCTGAGGGAGACCATAACTTGAGGGATTTGAGGGAACATGAGGGAGTGAGGGATTGAGGGATGAGGGATGAGGGATCTATGAGGGAGCAGTATGAGGGAATATGAGGGATGTGAGGGATATGAGGGACCAACTGAGGGATGTGAGGGATGAGGGAGATGAGGGATGAGGGATGAGGGACGTGAGGGATGAGGGAGTTGAGGGAGATGAGGGATGAGGGATGAGGGATGAGGGAGATGAGGGATTCGATGAGGGATCTCATGAGGGAGTGTGAGGGATGAGGGAGCGCTTAAGTGAGGGATGAGGGATACTGAGGGAGGCACTGAGGGATGAGGGATGAGGGATGTCTGTGAGGGATTGAGGGAAAAACATGAGGGAATGAGGGAATTGAGGGATGAGGGATGAGGGATCGGAGTGAGGGATGAGGGATAATTGAGGGACTGAGGGATTGAGGGAGTGAGGGAATGAGGGAGTGAGGGATCGTTCTGTGAGGGACTTTCTGAGGGATTGAGGGAAGTCACTGAGGGATGTCTTTGAGGGAATGAGGGAGTGAGGGATGAGGGATTGGATTGAGGGATACTTGAGGGATGTGAGGGATTTTCGGTGAGGGAACGTGAGGGATGAGGGAAATATTTGTGTGAGGGACGAATGAGGGAATTATTTGAGGGATGAGGGAGACTGAGGGATTGAGGGAAGGAGTGAGGGAGCAAGTCAATGAGGGATAGCCCTCGCGTGAGGGAATGAGGGATGAGGGATTGAGGGATGAGGGATTGAAGTGAGGGAGATGTGTATGCTTATGAGGGAATGAGGGATGGTGAGGGATGAGGGACAATGAGGGACGATGAGGGATTCTAGTGTTGTGAGGGATCAGGAACCATATATGAGGGAGCTGAGGGACCTGAGGGACGATGAGGGATTGAGGGAAATGAGGGATGAGGGAGTGAGGGATGAGGGATGAGGGAGGCGGTATGAGGGACTGAGGGATGAGGGAAGTTGAGGGATTTTGTGAGGGACGTTGAGGGATGAGGGACGAGTGAGGGATACATGCGGATGAGGGAGATTTGAGGGATCCCCACATGAGGGAGCCGCTCTGAGGGAGTGAGGGATCTTGAGGGAGGCTGAGGGATGAGGGAAGTGAGGGACGTGAGGGACTGAGGGAGTCCTGAGGGAGTGAGGGAACGGTGAGGGATTCTGAGGGAATGACTTTGAGGGACGCTTATGAGGGATCATTGAGGGATGAGTACCTGAGGGAGACTGAGGGATTCTGAGGGACTGAGGGATGAGGGAGTGGTTGAGGGATGAGGGAGTAGCTCCTGAGGGATGAGGGATGAGGGACCTGAGGGACTACCTGCATGGTGAGGGATATCAAGGAGTGAGGGACTTTGAGGGATTGAGGGATGAGGGACTTTGAGGGACCTGAGGGATGAGGGAATGAGGGATGTGAGGGAAATGAGGGATGAGGGACTGAGGGAAGTCTTGAGGGATGAGGGAGCTGAGGGATGAGGGATGAGGGACTGAGGGAGTGAGGGATGAGGGATGAGGGATGAGGGATTGAGGGACGGACTAATGAGGGAGAATCTGAGGGATGAGGGACGATGAGGGAGTTGAGGGAAGGCTTGAGGGAGTGAGGGACTGAGGGACTGAGGGACTGAGGGAAGACTGAGGGACTGAGGGATGCTGAGGGAATTGAGGGATGAGGGATGAGGGACTGAGGGACACTTGAGGGATGAGGGACACAAATGAGGGATATTTGAGGGAATGAGGGATCGGTGAGGGACCCTGAGGGATGAGGGACATGAGGGAGATGAGGGATGAGGGAAGCTTGAGGGACTGAGGGAGTGAGGGATCCCTGAGGGAGCTGAGGGAGAATTGAGGGATTTGAGGGAAGTCTGAGGGATATTTGAGGGATGAGGGAGATCAGATGAGGGACATGAGGGATTGAGGGATGAGGGATGAGGGAAAACTTGTTGAGGGATCCACTTGAGGGAAAAAAATGTACTTGAGGGAACTAGTCGTTGAGGGAGAGCTATTGAGGGATGAGGGACCTGAGGGATGAGGGATGAGGGATGAGGGATGAGGGATCATACTTGAGGGATGAGGGACTGAGGGAATACCTGAGGGATGTGTACGTTTTGAGGGACCTGAGGGATGAGGGAGATGAGGGAGTGAGGGAACTACTGAGGGATACGTGAGGGACATGAGGGAGTCTGAGGGACTGAGGGATGAGGGATCCTGAGGGAATTCAGAGAGGGCATGAGGGATCATGAGGGACGTGAGGGAGCGTAATGAGGGATGACAATGAGGGAGGATGAGGGATAGTCTGAGGGAATCGTGAGGGAAGCTGAGGGAAATGAGGGAATGAGGGACATGAGGGAGTGAGGGATGAGGGAGTGAGGGAAGTGTGAGGGAAATTTGAGGGAGGTGAGGGACTAATGAGGGATGAGGGACATGAGGGATGAGGGATCCTGAGGGAGCACTGAGGGACGTGAGGGAAGGACAGAGCCTGAGGGACGCCGACGCCTGAGGGATGAGGGATGAGGGAGCTTCCTGTTGAGGGAACTTGTAATTGAGGGATGTGAGGGACTGAGGGAGAGTATGAGGGATGAGGGACCGAACCTCTTGAGGGAGCTGAGGGATGAGGGACTGAGGGATGAGGGATACGTGAGGGAAAGTGAGGGAGTGAGGGATTGAGGGATGCTCTAGAGTTGAGGGAAGCTGAGGGATGAGGGAGCGCATGAGGGACTGAGGGATGAGGGATGAGGGAATATGAGGGACACTGAGGGACTGAGGGATGTAATGAGGGATGAGGGACCGTGAGGGAGACCGCAGATTTGAGGGACCCATTTGAGGGACTATGAGGGAGTGAGGGACTTGAGGGATATGAGGGATGAGGGATAGGTGAGGGAAACACCTTGCTGAATTGAGGGACTTACGTTAATCAATGAGGGATATTGAGGGACCTTGAGGGACGGGTGAGGGAGGTGAGGGAGTGAGGGACGACATGAGGGATTGAGGGATGAGGGAGCATGAGGGAGTGAGGGATATGAGGGAGATGAGGGATTAATGAGGGAGGCTGAGGGATGAGGGATTTGTTGAGGGAGTGTCCTTGAGGGATGAGGGAAGGCTGAGGGAGGCGATGAGGGAGATGAGGGATGAGGGATGAGGGATGAGGGAATCTGAGGGAAACTGAGGGATGAGGGAGGCTGGATGAGGGAACTGAGGGATGAGGGATTAATGAGGGATGAGGGATGAGGGATGAGGGATCGAGAAAACAATGAGGGAGTGAGGGAAATGAGGGAATGAGGGAGTTGAGGGATGAGGGAGGGTGAGGGAATCTGGCCCGATGAGGGAGGTCAATGAGGGACTGAGGGAGTGAGGGATGAGGGATGAGGGAAATGAGGGATTGAGGGACAGTGAGGGACACACCTTCATGAGGGACGAGGTGAGGGAATGAGGGACATCAATTTTGAGGGAGTGAGGGATGAGGGAGAGCATGATGAGGGATTGAGGGATGAGGGATGAGGGAATGAGGGATGAGGGATGAGGGATTGAGGGAGTGAGGGATGAGGGAATGAGGGACTAGTATGAGGGATTGAGGGATCATTCATATTGTGAGGGAAGTCCCGAGTGTTGAGGGATGAGGGAGTTGGCATTGAGGGACTGAGTGAGGGACAGAGGTAGTCGGCTGAGGGAGATGAGGGAGCTGAGGGAGATGAGGGATGAGGGACGTGAGGGATATGAGGGATGAGGGATGAGGGATGAGGGAAGGATTGAGGGAGGCTGATGCGTGAGGGAGTTGAGGGACTTGATTGAGGGACTGAGGGAGTTGAGGGATTGAGGGACGCTGAGGGAAACCCTGAGGGATTCTGGGTGAGGGATGAGGGATGCTGAGGGAAGCGGTGAGGGATGAGGGAGATGGCAAAATGAGGGAATGAGGGAGCTGAGGGAACTAGATGAGGGATGTGTTGAGGGATTGAGGGAATACTTGAGGGATATGAGGGATGTTCGTCCGAAATGAGGGAGGTTGAGGGATGAGGGAAACCATTGAGGGAATTGAGGGATGAGGGATAATGGAACCTGAGGGACCTGAGGGAATGAGGGATGAGGGAGTGTGATGAGGGACATGAGGGATGAGGGATGAGGGAATCAGAGCTGAGGGATTGAGGGAAAGTTGAGGGACCCAAGACACTGAGGGAGATGAGGGAAACAGTTGAGGGATTGAGGGATATTATGAGGGATTTTGAGGGAGGTGAGGGATTGAGGGAGCGTGAGGGACTGAGGGATGAGGGAATCTGAGGGAACTGTGTGAGGGAAACTCGTGAGGGATGAGGGATGAGGGAATGAGGGACCGTGAGGGATGAGGGATGAGGGATGAGGGACATGAGGGATGAGGGAGGTGAGGGATGAGGGAAACCGTTTGAGGGACATGCTCAGAGACTGAGGGACTTGAGGGAGTCTTGAGGGACCCGTGAGGGAAATGAGGGAACGAAGATCCTTCCCGTGAGGGAGGATGCGCGCTTGAGGGATGCTTGTATGTGAGGGACTGAGGGAGATGAGGGATCTCTTGAGGGATGAGGGAGTTGAGGGAATGAGGGAGCTTGAGGGAGATGGTGAGGGATGAGGGATTTTGAGGGATCTTTGAGGGATCATGCCTGAGGGATGAGGGATGAGGGATGAGGGATGAGGGATGAGGGAACTGACATGAGGGATTGAGGGACACTAAAGAGCGCTGCGGGCGTGAGGGATATGTGAGGGAAGTGAGGGATGAGGGAATGAGGGATTGAGGGATAGTGGCCATTATTGAGGGATCTGAGGGATGAGGGAGATGAGGGATGAGGGACACGGATTGAGGGAGGCGCATGAGGGATCTTGAGGGATTTGAGGGACTGAGGGACTGAGGGACCCTGAGGGAATGAGGGATGAGGGATGAGGGACTTTGTGAGGGAACGGAAGTGAGGGAGTGAGGGATGTGAGGGAGGGTGAGGGAGACATTGAGGGACGTCACCCTGAGGGATTGAGGGATGAGGGATGAGGGACGTGAGGGACTGAGGGAATAGATCCTGAGGGACAATGAGGGAATTGAGGGAGTTGAGGGAGTGAGGGAGCCCCATGAGGGATGAGGGACTGTTTCTGCCTATTTGAGGGAGGTGAGGGAGGTTCTGAGGGATGAGGGAGTGAGGGAGTGAGGGATTGAGGGACTTGAGGGATGAGGGATTGAGGGAAGGTGAGGGATGAGGGAGTGAGGGATGAGGGAGTGAGGGAAAGTCCGGGACCCTTGAGGGAATGAGGGATTGAGGGATTAGTGAGGGATGAGGGATGAGGGAATGAGGGAGGTGTGAGGGACTGAGGGATGAGGGATGAGGGATGAGGGATGAGGGAAGGTGAGGGAGTCCAAGTGAGGGATGAGGGATGAGGGATTCTGAGGGAGTTTCATTGCAGTGAGGGACATGATGAGGGAGTTGAGGGAAGTGGCCCGTGTTATTGAGGGAAGTGTGAGGGATTGAGGGAATGAGGGACTGAGGGAGGTTAAAGTCATATGGGATCCCTATGAGGGATGAGGGATGAGGGATACAGTGAGGGAGTGAGGGAGTGAGGGATGAGGGAATGAGGGATTGAGGGATGTGTGAGGGACGTGAGGGATGAGGGAATCTATGAGGGATGAGGGACCTGAGGGATGAGGGATTATGGCCGGCTGATGAGGGACAATGAGGGATTCTGAGGGACTGAGGGAATGAGGGAATTGAGGGATGAGGGACTGAGGGACGTGAGGGAATGAGGGAATGAGGGATGAGGGAGCGATGAGGGATTGAGGGACCGTGAGGGAGAATGAGGGAAAGATGAGGGATTGAGGGATGTGAGGGATGAGGGAAGTGAGGGATGAACCGTGAGGGATGAGGGATTGAGGGAACGTGAGGGATGAGGGACAATGAGGGATGAGGGATATTGAGGGAGTGAGGGATGCAACCAGATGGCTTAACATTTGAGGGACATTGAGGGAACTTGAGGGAATGAGGGATGAGGGACTGAGGGAGACTGAGGGATGAGGGATCTAGTGAGGGATTAATGAGGGATGAGGGATGAGGGATTGAGGGACCTGAGGGAACTGAGGGAGTGAGGGATGAGGGATTGTTGAGGGATGAGGGACATATTGAGGGAGTGAGGGACAATGAGGGACGCGGTTCGCTGAGGGACTGAGGGATCGTGAGGGAAAATGAGGGACGCTGGATGAGGGACTGAGGGAATATGAGGGATAGGGTCAGCTGAGGGAAGGATTGTTATGGTGAGGGACTGAGGGATTTGAGGGACGTGGGTGAGGGATGAGGGACCAGTGAGGGATGAGGGAAAAAGGATTCGTGAGGGATGAGGGAGTTATGAGGGAGTGAGGGATTGAGGGAGTGAGGGAGTGAGGGATGAGGGATGCGGTCTGAGGGAAACCTGAGGGAAATTAAGTGAGGGATGAGGGACTTCATTGAGGGATAAGAATGAGGGAGTGAGGGATTCAACTGAGGGAGGGACTGAGGGATGAGGGAACCGTTGAGGGAGTGAGGGATGAGGGACCCATGAGGGACGTGAGGGACGGATCTGAATGAGGGACTTGAGGGAGGTCACTTGAGGGATACATTTGAGGGAATGAGGGATCGCTTGAGGGACTGAGGGAACTGAGGGAGTGAGGGAGCTTACCCGGCTGAGGGACTTGAGGGACGCATGAGGGATACCTGAGGGAAAGATGAGGGACGGTGAGGGATGGCCTTATGAGGGATTGAGGGATGAGGGATGAGGGAAGTGAGGGATGAGGGATGAGGGATGAGGGACTGAGGGAAGTGAGGGACCTGAGGGAATGAGGGATGTTGATTGAGGGACCTGAGGGATGTTGAGGGATTGAGGGACTGAGGGAAGTGAGGGAGGTGAGGGATGAGGGATGAGGGATGAGGGATGAGGGAAGGATGAGGGATTCGAGCGTGAGGGATATGAGGGATGAGGGATCCTTAGTGAGGGAACAATTGAGGGATGAGGGATGAGGGACAATGAGGGATTGAGGGATCCTGAGGGATGAGGGAGTGCCTTGAGGGATGAGGGACTGAGGGATATGGTGCTTGAGGGACCACTGAGGGACTGAGGGAATGAGGGAGTGCAAAGTGAGGGATTTCTGAGGGATGAGGGAAACCGTATGAGGGACTGATGAGGGATAAAGTGAGGGAATGAGGGACGCACTATGAGGGATGAGGGATGAGGGATGAGGGAAGAGGTGAGGGATGCCTTGAGGGATAGCTGAGGGAGAGTGAGGGATCGGTGAGGGAGATATGAGGGAGTGAGGGATCGTGAGGGAATGAGGGACATGAGGGATGAGGGATGAGGGATGAGGGATTGGACTGAGGGATGAGGGAACATGAGGGACTGAGGGATCATCATGAGGGAATTTGTGAGGGACCGAATATGAGGGAAATTGAGGGAGTGAGGGAAAGACTGTGAGGGACAGACTTGAGGGAAGTGAGGGATTGAGGGATTTGAGGGAGTGAGGGAGCACGGGGGAGACATGAGGGATGAGGGACATGAGGGATTGAGGGACGATGAGGGAGTCTGAGGGATTATTTGCCTAGGGTGAGGGACCTTGAGGGATGAGGGAATGAGGGATGAGGGAGTTGAGGGATGAGGGATGATGAGGGAGATACCTCTGAGGGAAGTGAGGGATGGGCTTGAGGGAAATAATGAGGGATTGAGGGATTGAGGGAATGGATTGAGGGAAATGAGGGAGGATTGTACTGAGGGATGAGGGATTGAGGGACTCTGAGGGATTGAGGGAGTGAGGGATTGAGGGAACTGAGGGAAATGAGGGAGTGAGGGACTTCTGAGGGATGATTTGAGGGATGAGGGATGAGGGATGTAAACCATGAGGGATGAGGGAGGACGCGTACTGAGGGACTTATCATGAGGGATTGAGGGAGTGAGGGACGTGAGGGAATTGAGGGATGAGGGATGAGGGACTGAGGGAGCTGAGGGACTGAGGGATGAGGGAGTTTAGGCCCTGAGGGATTGAGGGAACTGATTCATGAGGGATTCATGAGGGATGAGGGATGAGGGATGAGGGAAGCAATATGAGGGACCTTGAGGGAGTGGTTTGAGGGAATTGAGGGATTGAGGGATTACACTTGAGGGAGGTGAGGGATGAGGGAAGTGAGGGATGAGGGATGCTTGTGAGGGAGTGAGGGAGTGAGGGACATGAGGGACTGAGGGAGCCCCGTTTGGGCGTTGAGGGATGAGGGATCGTGAGGGATGAGGGATTGAGTGAGGGATGAGGGACTGAGGGACGGCTTGAGGGATGAGGGATGAGGGACGCTCGATGCGGGAGTGAGGGATCTAAGCATGAGGGAATGTTGAGGGATTCGTGAGGGATGAGGGAGGTGAGGGATTGAGGGAGGCGTGAGGGATATTGAGGGATGAGGGATGAGGGATGAGGGAGAGTGAGGGATGAGGGATTCTGAGGGAGACTGAGGGAGATGAGGGAAATGAGGGAAGATGAGGGAGCCTTGTGAGGGAATGAGGGAATGAGGGACGCCGCTACCTTGAGGGAGATAATTGAGGGAATCTAAATGAGGGACTGAGGGAGTGAGGGATGAGGGATCATAGTGGCTGAGGGAATGAGGGACATATGAGGGAGTTTGGATGAGGGATTTGAGGGAATCTGAGGGAGACGAATTCCTCTGAGGGATGAGGGATGAGGGATGAGGGAGTGAGGGATGAGGGATTGAGGGAGCGTGAGGGATGTGAGGGAATGAGGGATGAGGGAATGAGGGACTGAGGGACAGCCTGAGGGAATATTGAGGGACTGAGGGAAAGTGGCTGAGGGACCTGAGGGATCCTTGAGGGATGACTGAGGGACACTGAGGGATCGTGAGGGATCGTTACCTAATGAGGGATGAGGGAATGAGGGAACTTGAGGGACGTGCGCTGAGGGATTGAGGGAGATATGAGGGATCCGTGAGGGATATCTTGGGTGAGGGAGTGAGGGATGTGAGGGATTATGAGGGACGTGAGGGACATGAGGGAAATGAGGGAAATGAGGGACAGGTCTGGTTGAGGGATTGAGGGATCGTGAGGGAGTGAGGGATGAGGGACTGAGGGAA",
		"TGAGGGATG")
	if result != expected {
		t.Errorf("Expected %v but got %v", expected, result)
	}
}

func TestSubStringPositionsAsString_Vibrio_Cholerae(t *testing.T) {
	data, err := ioutil.ReadFile("Vibrio_cholerae.txt")
	if err != nil {
		t.Errorf("error opening datafile: %v", err)
	}
	dna := strings.ToUpper(string(data))

	expected := "60039 98409 129189 152283 152354 152411 163207 197028 200160 357976 376771 392723 532935 600085 622755 1065555"
	result := SubStringPositionsAsString(
		dna,
		"CTTGATCAT")

	if result != expected {
		t.Errorf("Expected %v but got %v", expected, result)
	}
}

func TestFrequentWords(t *testing.T) {
	wanted := []FreqWordResult{
		{Pattern: "CATG", Count: 3},
		{Pattern: "GCAT", Count: 3},
	}
	results := FrequentWords("ACGTTGCATGTCGCATGATGCATGAGAGCT", 4)

	for _, w := range wanted {
		res, ok := results[w.Pattern]
		if !ok || res.Count != w.Count {
			t.Errorf("Wanted %v but got %v", w, res)
		}
	}
}

const ThermotogaPetrophila = `aactctatacctcctttttgtcgaatttgtgtgatttatagagaaaatcttattaactgaaactaaaatggtaggtttggtggtaggttttgtgtacattttgtagtatctgatttttaattacataccgtatattgtattaaattgacgaacaattgcatggaattgaatatatgcaaaacaaacctaccaccaaactctgtattgaccattttaggacaacttcagggtggtaggtttctgaagctctcatcaatagactattttagtctttacaaacaatattaccgttcagattcaagattctacaacgctgttttaatgggcgttgcagaaaacttaccacctaaaatccagtatccaagccgatttcagagaaacctaccacttacctaccacttacctaccacccgggtggtaagttgcagacattattaaaaacctcatcagaagcttgttcaaaaatttcaatactcgaaacctaccacctgcgtcccctattatttactactactaataatagcagtataattgatctga`

func TestFrequentWords_(t *testing.T) {
	results := FrequentKWords(strings.ToUpper(ThermotogaPetrophila), 3, 9)

	fmt.Printf("%+v\n", results)
}

func TestFrequentWords_2(t *testing.T) {
	results := FrequentKWords(strings.ToUpper("CGGAGGACTCTAGGTAACGCTTATCAGGTCCATAGGACATTCA"), 3, 3)

	fmt.Printf("%+v\n", results)
}

func TestFrequentWords2(t *testing.T) {
	results := FrequentKWords(strings.ToUpper(vibrioCholerae), 3, 9)

	fmt.Printf("%+v\n", results)

	wanted := vibrioCholeraeResults
	for k, wants := range wanted {
		res, ok := results[k]
		if !ok {
			t.Errorf("Wanted a result for k-mer %v but got none\n", k)
		}
		for _, w := range wants {
			got, ok := res[w.Pattern]
			if !ok || got.Count != w.Count {
				t.Errorf("Wanted %v but got %v\n", w, got)
			}
		}
	}
}

var vibrioCholeraeResults = map[int][]FreqWordResult{
	//      k-mer              results
	3: {{Pattern: "TGA", Count: 25}},
	4: {{Pattern: "ATGA", Count: 12}},
	5: {{Pattern: "GATCA", Count: 8}, {Pattern: "TGATC", Count: 8}},
	6: {{Pattern: "TGATCA", Count: 8}},
	7: {{Pattern: "ATGATCA", Count: 5}},
	8: {{Pattern: "ATGATCAA", Count: 4}},
	9: {
		{Pattern: "ATGATCAAG", Count: 3},
		{Pattern: "CTTGATCAT", Count: 3},
		{Pattern: "TCTTGATCA", Count: 3},
		{Pattern: "CTCTTGATC", Count: 3},
	},
}

const vibrioCholerae = `atcaatgatcaacgtaagcttctaagcatgatcaaggtgctcacacagtttatccacaac
			ctgagtggatgacatcaagataggtcgttgtatctccttcctctcgtactctcatgacca
			cggaaagatgatcaagagaggatgatttcttggccatatcgcaatgaatacttgtgactt
			gtgcttccaattgacatcttcagcgccatattgcgctggccaaggtgacggagcgggatt
			acgaaagcatgatcatggctgttgttctgtttatcttgttttgactgagacttgttagga
			tagacggtttttcatcactgactagccaaagccttactctgcctgacatcgaccgtaaat
			tgataatgaatttacatgcttccgcgacgatttacctcttgatcatcgatccgattgaag
			atcttcaattgttaattctcttgcctcgactcatagccatgatgagctcttgatcatgtt
			tccttaaccctctattttttacggaagaatgatcaagctgctgctcttgatcatcgtttc`
